---
import Polaroid from "../../commons/Polaroid.astro";

import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
  .slice(0, 3); // solo gli ultimi 3
---
<section id="latest-posts" aria-labelledby="latest-posts-heading" role="region" data-aos="zoom-in" data-aos-easing="ease-in-back" data-aos-delay="300" data-aos-duration="1500" class="mt-8">
  <h2 class="sr-only" id="latest-posts-heading">Ultimi contenuti del blog</h2>
  <div class="bg-gradient-to-b from-[#CDABED] via-[#E1CDF4] to-[#FFFFD6] rounded-lg" aria-labelledby="latest-posts-heading">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3 place-items-center">
        {posts.map((post, index) => {
          return (<a href={`/blog/${post.id}/`} class="relative rounded-md p-3 w-full max-w-xs transform hover:-rotate-1 hover:scale-105 transition duration-300 group text-black! polaroid-link" aria-label={`Vai all'articolo: ${post.data.title}`}>
              <Polaroid src={post.data.heroImage?.src} alt={post.data.heroImgAlt || post.data.title} aos={"fade-up"} caption={post.data.title} class={`relative bg-white p-3 w-full shadow-[1rem_1rem_1rem_-0.5rem_rgba(0,0,0,0.54)] my-3 lg:my-16 mx-auto text-right transition-all duration-300 ease-in-out hover:-top-4 hover:cursor-pointer`} isLast={index === 0} description={post.data.description} itemtype="http://schema.org/BlogPosting" year={`${post.data.pubDate.getUTCDay()}/${post.data.pubDate.getUTCMonth()}/${post.data.pubDate.getUTCFullYear()}`} />
          </a>
        )})}
      </div>
    </div>
  </div>
  <div class="flex justify-center mt-12">
      <a href="/blog" aria-label="Vai alla pagina Blog" class="btn-funky">
          <span class="btn-funky-content">
              Tutti i commenti non richiesti
          </span>
      </a>
  </div>
</section>